# trade_daishin
# 다음 사항
- 입력 제한 사항 마무리 단계
- 호출 제한 사항 명확히(주문,계좌 7초당 10건 / 정보 조회 15호 60건 / 조건식 최대 4개 / 실시간 시세 최대 400개)
- 한국투자증권 연동(단독 모드)
- Telegram 조작

# 자동 매매 서비스
❓ Problem1 : 증권사 자체 프로그램을 매일 켜야하거나 수수료가 비싸다. => 대신(크레온) 서버매매 => 각 방향 0.19%

❓ Problem2 : 상용 프로그램은 비용적인 것도 있지만 비율로 거래하는 것이 없다. => 개수 혹은 금액으로 거래

❓ Problem3 : 키움을 기반으로 하는 것은 많아도 대신이나 한국투자증권은 없다.

‼ Idea1 : 원하는 기능이 있는 증권사 API 기반 매매 프로그램을 만들고 이를 기반으로 다른 증권사 것도 만들자.

‼ Idea2 : 중단된 퀀트 프로그램을 지속적으로 개발하여 해당 매매 프로그램과 연동해 사용할 수 있도록 하자.

💯 Solution : API 기반 자체 매매 프로그램 + 퀀트 프로그램

# 사용기술
- C#, Visual Studio(2019), Github

# 사용 API
- Crean Api
- KIS Open_API(예정)

# 참고 자료
- 팡규의 자동 매매 프로그램, 번개트레이더
- 사이트 : https://fors.tistory.com/355
- 사이트 : https://joel-helloworld.tistory.com/68
- 기타 : Claude Sonnet, Copilot, GPT 3.5

# 디자인
- FORM0 : 자동실행 및 업데이트

![image](https://github.com/krkr5628/trade_daishin/assets/75410553/e132d15e-d9e1-40a8-8594-83193ffa7f37)

- FORM1 : 메인 화면

![image](https://github.com/krkr5628/trade_daishin/assets/75410553/ce374564-c849-41fb-8d50-15461ea946f0)

- FORM2 : 매매 설정

![image](https://github.com/krkr5628/trade_daishin/assets/75410553/dd9131f1-177f-4925-8df7-24da50a03afd)

- FORM3 : 매매 확인

![image](https://github.com/krkr5628/trade_daishin/assets/75410553/7c7e8635-0493-4530-a218-7ca3c88e793a)

- FORM4 : 로그 확인
  
![image](https://github.com/krkr5628/trade_daishin/assets/75410553/ad3000c8-926a-469c-9118-1447d5482d79)

- FORM5 : 업데이트 및 동의사항

![image](https://github.com/krkr5628/trade_daishin/assets/75410553/45af573c-95ee-4a1a-8634-f4c18ebd9f99)

# 특징
- 증권사 실시간 조건 검색을 활용하여 매수 매도 가능
- 클라우드 VM을 통해 24시간 자동 거래 가능
- 특정 시간에 시작 및 종료 가능
- Telegram을 통한 매매 현황 보고
- KIS(한국투자증권)과 연계하여 거래 가능(진행중)
- 퀀트 프로그램과 연계(계획중)

# 매수 모드(택1)
- 종목당 매수 금액
- 종목당 매수 수량
- 종목당 매수 비율

# 기타 매수 설정
- 운영 시간 : 매매(익절 및 손절)가 작동하는 시간
- 초기 자산 : 사용자가 투입한 투자 금액 개별 설정
- 종목당 최대 매수 금액
- 최대 매수 종목 수
- 최소 종목 매수가
- 최대 종목 매수가

# 추가 매수 옵션
- 최대 계좌 보유 종목 수
- 당일 중복 매수 금지
- 매수 시간전 검출 매수 금지
- 보유 종목 매수 금지

# 조건식 작동 시간
- 정규장 시간 : 09:00:00 ~ 15:30:00
- 수능과 같은 특별한 날은 개별 고려

# 매수 조건식 모드(택1)
- 조건식 최대 2개 제한
- OR MODE : 1개 이상의 조건식에발견된 종목을 매매
- AND MODE : 2개 이상의 조건식에 동시에 발생한 종목을 매매
- INDEPENDENT MODE : 1개 이상의 조건식에서 발견된 종목을 조건식에 따라 각각 매매
- Dual MODE : 종합계좌(01)과 ISA계좌(11)에 대해 각각 조건씩 매매

# 매도 조건식 모드
- 매수된 종목이 매도 조건식에 발생하면 그때 매도 하는 기능

# 매매 설정
- 익절 및 손절 % : 수익 %에 도달하면 발생
- 익절 및 손절 원 : 수익 금액에 도달하면 발생
- 일절 및 손절 TS(개발중)
- 동시호가 설정(지정가) : 15:40 ~ 16:00:00
- 시간외단일가 설정(지정가) : 16:00:00 ~ 18:00:00

# 매매방식
- 지정가 : 이벤트가 발생한 시점의 현재가에 대하여 -5호가 ~ 5호가
- 시장가 : 시장가 매매
- 분할(계획중)

# 청산 설정
- 기본적으로 시장가 매매
- 청산 익절 및 손절 %
- 동시호가 설정(지정가) : 15:40 ~ 16:00:00
- 시간외단일가 설정(지정가) : 16:00:00 ~ 18:00:00

# 5가지 매매 상태
- 대기 : 편입 후 아무 동작 없음 OR 중복 매수가 가능한 상태
- 호출 : AND 모드에 대한 거래로 1번 발생시 변경되는 형태
- 매수중 : 매수 주문이 들어간 상태
- 매수확인 : 매수가 완료된 상태
- 매도중 : 매도 주문이 들어간 상태
- 매도확인 : 매도가 완료된 상태

# 기타 설정
- 매수 텀 : 매수 이후 다음 매수까지의 지연 시간
- 매도 텀 : 매도 이후 다음 매도까지의 지연 시간
- 미체결매수취소 : 매수 일정 시간 뒤 미체결 매수 취소 (개발중)
- 미체결매도취소 : 매도 일정 시간 뒤 미체결 매도도 취소 (개발중)

# 동작 순서(수정)
- 시간 표시 작동, 테이블 세팅
- 저장된 설정 사항 불러오기
- 로그인 동작
- 로그인 성공시 사용자 정보 받아오기
- 조건식, 예수금, 계좌 잔고 받아오기
- 계좌잔고를 바탕으로 TABLE에 실시간 정보 추가
- 실시간 조건 검색 시작
- MODE 따른 종목 편입
- 실시간 종목 편입 및 계좌 200ms 감시 그리고 매수 조건시간 등을 통한 매수 실시 그리고 TABLE 편입 시간 내림차순 정렬
- 보유 종목 수와 매매 횟수 등을 확인
- 매수 주문 후 매수 체결 현황 파악
- 매수 완료 후 잔고 정보 업데이트 및 세금 업데이트
- 실시간 매도 종목 편입 및 계좌 200ms 감시 그리고 조건시간 등을 통한 매도 실시
- 비율, 금액 등의 조건을 확인하여 매도 동작 수행
- 매도 주문 후 매도 체결 현황 파악
- 매도 완료 후 잔고 정보 업데이트, 예수금 업데이트, 수익 및 세금 정보 업데이트
- 중복 매수 허용할 경우 매도 완료 후 대기로 재진입하여 다시 매수 할 수 있도록 실시

# 지수 선물 연동
- 외국인선물순매수, 코스피선물, 코스닥선물, DOW30, S&P500, NASDAQ100과 연계하여 실행 여부 결정
- 매수, 청산, ISA에서 연동 가능

# TELEGRAM
- 사용자의 ID 및 토큰을 확인하여 간단한 매매 현황 전송
- 시작, 종류, 간단한 정보 받기(계획중)
  
# KIS(개발중)
- 한국투자증권의 OPEN_API를 통해 거래
- 분할 숫자를 넣어서 예수금의 N비율만큼 거래

# 매매확인
- 저장된 매매 내역 확인
- 저장된 매매 내역을 통한 수익 계산 표

# 업데이트 및 동의사항(개발중)
- 누적 업데이트 사항
- 사용상 책임소재에 대한 동의사항
- 인증번호 확인(개발중)
